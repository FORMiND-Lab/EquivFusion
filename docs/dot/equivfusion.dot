digraph G {
  rankdir = TB
  splines=spline
  node [shape=box style=filled fillcolor="white" width=2]
  nodesep=0.2 // horizontal compression
  ranksep=0.5 // vertical compression
  compound=true

  // input fronttends
  subgraph cluster_inputs{
      label = "Inputs"
      node [fillcolor="#ffff99"]
      SV
      Netlist
      C [label="C/C++"]
      Pytorch
      Chisel
      C [label="C/C++"]
  }


  subgraph cluster_tools {
    label = "External Tools"
    Slang
    Polygeist
    TorchMLIR [label="torch-mlir"]
  }


  FIRFile [label=".fir" fillcolor="#7fc97f" shape="note"]

  // equivfusion
  subgraph cluster_equivfusion {
      label = "EquivFusion"

      MLIR

      subgraph cluster_core_dialects {
          label = "Core dialects"
          node [fillcolor="#ffcc99"]
          HW
          Seq
          Comb
          Verif

          Seq -> Comb [label="unroll"]
          Seq -> HW [label="unroll"]
          Seq -> Verif [style=invis]
      }

      subgraph cluster_outputs {
          label = "Output Formats"
          node [fillcolor="#beaed4"]
          SMTLIB
          AIGER
          BTOR2
          {rank=same SMTLIB -> AIGER -> BTOR2 [style=invis]}
      }

      subgraph cluster_solvers {
          label = "Solvers"
          node [fillcolor="#7fc97f"]
          z3
          bitwuzla
          btormc
          kissat
          other [label="..."]
          {rank=same z3 -> kissat -> bitwuzla -> btormc -> other [style=invis]}
      }

      MLIR -> Seq         [lhead=cluster_core_dialects minlen=2]
      Comb -> AIGER       [ltail=cluster_core_dialects lhead=cluster_outputs minlen=2]
      AIGER -> bitwuzla   [ltail=cluster_outputs lhead=cluster_solvers minlen=2]
  }


  Pytorch -> TorchMLIR -> MLIR
  C -> Polygeist -> MLIR
  Netlist -> Slang
  SV -> Slang -> MLIR
  Chisel -> FIRFile -> MLIR
}
